<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link rel="icon" href="/assets/images/logo.png">

<title>Persistent Data Structures | Flashreads</title>

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Persistent Data Structures | Flashreads</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Persistent Data Structures" />
<meta name="author" content="Pavle Jonoski" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Persistent Data Structures" />
<meta property="og:description" content="Persistent Data Structures" />
<link rel="canonical" href="http://localhost:4000/005-persistent-data-structures/" />
<meta property="og:url" content="http://localhost:4000/005-persistent-data-structures/" />
<meta property="og:site_name" content="Flashreads" />
<meta property="og:image" content="http://localhost:4000/assets/images/datas.svg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-10-28T14:42:44+01:00" />
<script type="application/ld+json">
{"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/logo.png"},"name":"Pavle Jonoski"},"@type":"BlogPosting","headline":"Persistent Data Structures","dateModified":"2020-10-28T14:42:44+01:00","datePublished":"2020-10-28T14:42:44+01:00","image":"http://localhost:4000/assets/images/datas.svg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/005-persistent-data-structures/"},"url":"http://localhost:4000/005-persistent-data-structures/","author":{"@type":"Person","name":"Pavle Jonoski"},"description":"Persistent Data Structures","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    
<link href="/assets/css/screen.css" rel="stylesheet">

<link href="/assets/css/main.css" rel="stylesheet">

<script src="/assets/js/jquery.min.js"></script>

</head>




<body class="layout-post">
	<!-- defer loading of font and font awesome -->
	<noscript id="deferred-styles">
		<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	</noscript>


<!-- Begin Menu Navigation
================================================== -->
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">

    <div class="container pr-0">

    <!-- Begin Logo -->
    <a class="navbar-brand" href="/">
    <img src="/assets/images/logo.png" alt="Flashreads">
    </a>
    <!-- End Logo -->

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarMediumish">

        <!-- Begin Menu -->

            <ul class="navbar-nav ml-auto">               
                <li class="nav-item">
                <a target="_blank" class="nav-link" href="https://github.com/flashreads/blogs"><i class="fab fa-github"></i> Write in GitHub</a>
                </li>

                <script src="/assets/js/lunr.js"></script>


<style>
    .lunrsearchresult .title {color: #d9230f;}
    .lunrsearchresult .url {color: silver;}
    .lunrsearchresult a {display: block; color: #777;}
    .lunrsearchresult a:hover, .lunrsearchresult a:focus {text-decoration: none;}
    .lunrsearchresult a:hover .title {text-decoration: underline;}
</style>


<form class="bd-search" onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
    <input type="text" class="form-control text-small launch-modal-search" id="lunrsearch" name="q" maxlength="255" value="" placeholder="Type and enter..."/>
</form>

<div id="lunrsearchresults">
    <ul></ul>
</div>

<script src="/assets/js/lunrsearchengine.js"></script>

            </ul>

        <!-- End Menu -->

    </div>

    </div>
</nav>
<!-- End Navigation
================================================== -->

<div class="site-content">

<div class="container">

<!-- Site Title
================================================== -->
<div class="mainheading">
    <h1 class="sitetitle">Flashreads</h1>
    <p class="lead">
        Flashreads blogs
    </p>
</div>

<!-- Content
================================================== -->
<div class="main-content">
    <!-- Begin Article
================================================== -->
<div class="container">
    <div class="row">

        <!-- Post Share -->
        <div class="col-md-2 pl-0">
            <div class="share sticky-top sticky-top-offset">
    <p>
        Share
    </p>
    <ul>
        <li class="ml-1 mr-1">
            <a target="_blank" href="https://twitter.com/intent/tweet?text=Persistent Data Structures&url=http://localhost:4000/005-persistent-data-structures/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fab fa-twitter"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://facebook.com/sharer.php?u=http://localhost:4000/005-persistent-data-structures/" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
                <i class="fab fa-facebook-f"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/005-persistent-data-structures/" onclick="window.open(this.href, 'width=550,height=435');return false;">
                <i class="fab fa-linkedin-in"></i>
            </a>
        </li>

    </ul>
    
    <div class="sep">
    </div>
    <ul>
        <li>
        <a class="small smoothscroll" href="#disqus_thread"></a>
        </li>
    </ul>
    
</div>

        </div>

        <!-- Post -->
        

        <div class="col-md-9 flex-first flex-md-unordered">
            <div class="mainheading">

                <!-- Author Box -->
                
                <div class="row post-top-meta">
                    <div class="col-xs-12 col-md-3 col-lg-3 text-center text-md-left mb-4 mb-md-0">
                        
                        <img class="author-thumb" src="https://www.gravatar.com/avatar/0f5272e7bbb05483f5a83e60502cba42?s=250&d=mm&r=x" alt="Pavle Jonoski" title="Pavle Jonoski">
                        
                        <div>
                            By Pavle Jonoski
                        </div>
                    </div>
                </div>
                

                <!-- Post Title -->
                <h1 class="posttitle">Persistent Data Structures</h1>

            </div>

            <!-- Adsense if enabled from _config.yml (change your pub id and slot) -->
            
            <!-- End Adsense -->

            <!-- Post Featured Image -->
            

            
            <img class="featured-image img-fluid" src="/assets/images/datas.svg" alt="Persistent Data Structures">
            

            
            <!-- End Featured Image -->

            <!-- Post Content -->
            <div class="article-post">
                <!-- Toc if any -->
                
                <!-- End Toc -->
                <h1 id="persistent-data-structures">Persistent Data Structures</h1>

<p>Persistent data structures are <a href="https://en.wikipedia.org/wiki/Data_structure">data structures</a> that preserve the previous versions of the structure on modification.</p>

<p>They are effectively immutable, and depending on the implementation offer a special kind of memory optimization.</p>

<p>Being immutable, the persistent data structures are useful when writing concurrent code and the need arises to use some kind of data structure like list, tree, map or other.</p>

<p>When a persistent structure is modified, the original structure remains unchanged (it is a previous version), and the modification method returns a new structure that contains the modification.</p>

<p>Consider the following list:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>
a: 1 -&gt; 2 -&gt; 3

</pre></td></tr></tbody></table></code></pre></div></div>

<p>if we add another element to it, the list itself is modified:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>
a := add(a, 4)

a: 1 -&gt; 2 -&gt; 3 -&gt; 4

</pre></td></tr></tbody></table></code></pre></div></div>

<p>However if we use a persistent list, then the same operation would look like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>
a: 1 -&gt; 2 -&gt; 3

b := persistent_list_add(a, 4)



print(a)

1 -&gt; 2 -&gt; 3



print(b)

1 -&gt; 2 -&gt; 3 -&gt; 4

</pre></td></tr></tbody></table></code></pre></div></div>

<p>The method that adds an element to the list, actually returns a new list, containing the element we added.</p>

<p>The original list remains unchanged.</p>

<p>There are multiple ways that this can be achieved:</p>

<ul>
  <li>Doing copy-on-write - we copy the entire list in <code class="highlighter-rouge">b</code> then actually add the element, leaving the original list <code class="highlighter-rouge">a</code> unchanged.</li>
</ul>

<p>This however is not very memory efficient, as every modification would allocate memory for all previous elements - <code class="highlighter-rouge">O(n^2)</code> space complexity.</p>

<ul>
  <li>Using a linked list, but we only keep the pointer to the head and the tail of the list. This way we can share the unmodified elements and</li>
</ul>

<p>optimize the memory usage.</p>

<p>Let’s consider the second way of implementing this data structure. We want to reuse the elements from <code class="highlighter-rouge">a</code> and just add the final element.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>
a: head a           tail a

   \                   |

    +-&gt; (1) -&gt; (2) -&gt; (3)

   /                    \

b: head b                +-&gt; (4) tail b

</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="highlighter-rouge">a</code> and <code class="highlighter-rouge">b</code> share the first 3 elements, but only <code class="highlighter-rouge">b</code> can “see” the final added element.</p>

<p>When removing or updating an element, then we’re only copying the list up to the affected elements.</p>

<p>Let’s say we want to update the second element. Then we have to copy the head and the second element:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>
a: head a           tail a

   \                   |

    +-&gt; (1) -&gt; (2) -&gt; (3)

   /               /    \

b: head b         /      +-&gt; (4) tail b and c

                 /

    (1) -&gt; (7) -+

     |

c: head c

</pre></td></tr></tbody></table></code></pre></div></div>

<p>After changing the element <code class="highlighter-rouge">2</code> to <code class="highlighter-rouge">7</code>, we have to copy all affected elements, but the rest of the list</p>

<p>remains unchanged and shared between the previous versions. Note that all changes return new versions of the</p>

<p>list and we cannot directly modify previous versions - <code class="highlighter-rouge">a</code> and <code class="highlighter-rouge">b</code> remain unchanged after we do <code class="highlighter-rouge">set(b, 2, 7)</code>.</p>

<h2 id="an-example-of-persistent-list-in-python">An example of persistent list in Python</h2>

<p>Let’s implement this kind of structure in Python. Every list would contain nodes that hold the data</p>

<p>and point to the next node. The list itself will contain the HEAD and TAIL nodes.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
</pre></td><td class="rouge-code"><pre>
<span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>



    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

        <span class="bp">self</span><span class="o">.</span><span class="nb">next</span> <span class="o">=</span> <span class="bp">None</span>

    

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>



<span class="k">class</span> <span class="nc">PList</span><span class="p">:</span>



    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="n">head</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tail</span> <span class="o">=</span> <span class="n">tail</span>

    

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

        <span class="s">'''Adds to the end of the list.

        '''</span>

        <span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">:</span>

            <span class="k">return</span> <span class="n">PList</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>  <span class="c1"># Add first element in an empty list
</span>
        

        <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="o">.</span><span class="nb">next</span> <span class="o">=</span> <span class="n">node</span>



        <span class="c1"># Return the new list
</span>
        <span class="k">return</span> <span class="n">PList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>

    

    <span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="s">'''Removes the last element from the list.

        '''</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">:</span>

            <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">'Cannot pop from empty list'</span><span class="p">)</span>

        

        <span class="n">tail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span>

        <span class="k">while</span> <span class="n">tail</span><span class="o">.</span><span class="nb">next</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="p">:</span>

            <span class="n">tail</span> <span class="o">=</span> <span class="n">tail</span><span class="o">.</span><span class="nb">next</span>

        

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">PList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">)</span>

    

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

        <span class="s">'''Updates the element at index and returns the updated list.

        '''</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">:</span>

            <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">'Empty list.'</span><span class="p">)</span>

        

        <span class="n">lst</span> <span class="o">=</span> <span class="n">PList</span><span class="p">()</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span>

        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">index</span> <span class="ow">and</span> <span class="n">node</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="p">:</span>

            <span class="n">lst</span> <span class="o">=</span> <span class="n">lst</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

            <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="nb">next</span>

            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        

        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">index</span><span class="p">:</span>

            <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">'Index out of bounds'</span><span class="p">)</span>

        

        <span class="n">lst</span> <span class="o">=</span> <span class="n">lst</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>



        <span class="n">lst</span><span class="o">.</span><span class="n">tail</span><span class="o">.</span><span class="nb">next</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="nb">next</span>

        

        <span class="k">return</span> <span class="n">PList</span><span class="p">(</span><span class="n">lst</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="p">)</span>



    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>

        <span class="s">'''Removes the element at index.

        '''</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">:</span>

            <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">'Cannot remove from empty list'</span><span class="p">)</span>



        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

                <span class="k">return</span> <span class="n">PList</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">'Index out of bounds'</span><span class="p">)</span>



        <span class="n">lst</span> <span class="o">=</span> <span class="n">PList</span><span class="p">()</span>

        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">node</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="p">:</span>

            <span class="n">lst</span> <span class="o">=</span> <span class="n">lst</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

            <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="nb">next</span>

            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="p">(</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>

            <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">'Index out of bounds'</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="nb">next</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="p">:</span>

            <span class="c1"># Actually pop
</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        

        <span class="n">tail</span> <span class="o">=</span> <span class="n">lst</span><span class="o">.</span><span class="n">tail</span>

        <span class="n">tail</span><span class="o">.</span><span class="nb">next</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="nb">next</span>

        

        <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">PList</span><span class="p">(</span><span class="n">lst</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="p">)</span>



    <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="s">'''Returns an iterable (iterator) that goes through all elements of the list.

        '''</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">:</span>

            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span>

        <span class="k">while</span> <span class="n">node</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="p">:</span>  <span class="c1"># we must terminate at the tail of the list.
</span>
            <span class="k">yield</span> <span class="n">node</span><span class="o">.</span><span class="n">value</span>

            <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="nb">next</span>

        <span class="k">yield</span> <span class="n">node</span>

    

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">:</span>

            <span class="k">return</span> <span class="s">'[]'</span>

        <span class="k">return</span> <span class="nb">str</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterate</span><span class="p">()])</span>





<span class="n">a</span> <span class="o">=</span> <span class="n">PList</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'Lists a and b after adding element to a:'</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'a:'</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'b:'</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>



<span class="n">value</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">Lists after removing element from b:'</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'a:'</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'b:'</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'c:'</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">'(removed '</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="s">')'</span><span class="p">)</span>



<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">Lists after updating element in b:'</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'a:'</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'b:'</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'c:'</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'d:'</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p>After execution, it will print:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre>
Lists a and b after adding element to a:

a: [1, 2, 3]

b: [1, 2, 3, 4]



Lists after removing element from b:

a: [1, 2, 3]

b: [1, 2, 3, 4]

c: [1, 3, 4] (removed  2 )



Lists after updating element in b:

a: [1, 2, 3]

b: [1, 2, 3, 4]

c: [1, 3, 4]

d: [1, 7, 3, 4]

</pre></td></tr></tbody></table></code></pre></div></div>

<p>which is exactly what we intended and wanted - every list is immutable and we can add/remove/update elements and</p>

<p>by doing so we get new lists.</p>

            </div>

            <!-- Rating -->
            

            <!-- Post Date -->
            <p>
            <small>
                <span class="post-date"><time class="post-date" datetime="2020-10-28">28 Oct 2020</time></span>           
                
                </small>
            </p>

            <!-- Post Categories -->
            <div class="after-post-cats">
                <ul class="tags mb-4">
                    
                    
                    
                    <li>
                        <a class="smoothscroll" href="/categories#other">other</a>
                    </li>
                    
                    
                </ul>
            </div>
            <!-- End Categories -->

            <!-- Post Tags -->
            <div class="after-post-tags">
                <ul class="tags">
                    
                    
                    
                    <li>
                        <a class="smoothscroll" href="/tags#data-structure">#data-structure</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/tags#optimization">#optimization</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/tags#python">#python</a>
                    </li>
                    
                    
                </ul>
            </div>
            <!-- End Tags -->

            <!-- Prev/Next -->
            <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
            
            <a class="prev d-block col-md-6" href="//023-LibrariesForNaturalLanguageProcessing/"> &laquo; Useful Python libraries For Natural Processing</a>
            
            
            <a class="next d-block col-md-6 text-lg-right" href="//020-NumPy/">Python NumPy Array &raquo; </a>
            
            <div class="clearfix"></div>
            </div>
            <!-- End Categories -->

        </div>
        <!-- End Post -->

    </div>
</div>
<!-- End Article
================================================== -->


<!-- Review with LD-JSON, adapt it for your needs if you like, but make sure you test the generated HTML source code first: 
https://search.google.com/structured-data/testing-tool/u/0/
================================================== -->

</div>


    
</div>

<!-- Categories Jumbotron
================================================== -->
<div class="jumbotron fortags">
	<div class="d-md-flex h-100">
		<div class="col-md-12 p-5 align-self-center text-center">
            
            
                
                    <a class="mt-1 mb-1" href="/categories#vendor">vendor (25)</a>
                
                    <a class="mt-1 mb-1" href="/categories#bundle">bundle (25)</a>
                
                    <a class="mt-1 mb-1" href="/categories#ruby">ruby (25)</a>
                
                    <a class="mt-1 mb-1" href="/categories#2.5.0">2.5.0 (25)</a>
                
                    <a class="mt-1 mb-1" href="/categories#gems">gems (25)</a>
                
                    <a class="mt-1 mb-1" href="/categories#jekyll-feed-0.11.0">jekyll-feed-0.11.0 (10)</a>
                
                    <a class="mt-1 mb-1" href="/categories#spec">spec (24)</a>
                
                    <a class="mt-1 mb-1" href="/categories#fixtures">fixtures (18)</a>
                
                    <a class="mt-1 mb-1" href="/categories#news">news (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#jekyll-sitemap-1.2.0">jekyll-sitemap-1.2.0 (8)</a>
                
                    <a class="mt-1 mb-1" href="/categories#updates">updates (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#jekyll-paginate-1.1.0">jekyll-paginate-1.1.0 (6)</a>
                
                    <a class="mt-1 mb-1" href="/categories#source">source (6)</a>
                
                    <a class="mt-1 mb-1" href="/categories#javascript">javascript (22)</a>
                
                    <a class="mt-1 mb-1" href="/categories#git">git (9)</a>
                
                    <a class="mt-1 mb-1" href="/categories#python">python (38)</a>
                
                    <a class="mt-1 mb-1" href="/categories#databases">databases (7)</a>
                
                    <a class="mt-1 mb-1" href="/categories#linux">linux (15)</a>
                
                    <a class="mt-1 mb-1" href="/categories#java">java (24)</a>
                
                    <a class="mt-1 mb-1" href="/categories#other">other (9)</a>
                
                    <a class="mt-1 mb-1" href="/categories#html">html (5)</a>
                
                    <a class="mt-1 mb-1" href="/categories#ci">ci (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#go">go (3)</a>
                
                    <a class="mt-1 mb-1" href="/categories#kubernetes">kubernetes (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#jekyll-3.8.5">jekyll-3.8.5 (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#lib">lib (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#site_template">site_template (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#jekyll">jekyll (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#update">update (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#frontend,-frontendtips">frontend, frontendtips (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#frontend-development">frontend-development (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#java,-c++">java, c++ (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#flowchart">flowchart (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Python">Python (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#css,-flex">css, flex (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#css">css (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Javascript">Javascript (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#exception">exception (3)</a>
                
            
            
		</div>
	</div>
</div>


</div> <!-- /.site-content -->

<!-- Scripts
================================================== -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

<script src="/assets/js/mediumish.js"></script>



<script src="/assets/js/ie10-viewport-bug-workaround.js"></script> 


<script id="dsq-count-scr" src="//.disqus.com/count.js"></script>


</body>
</html>
