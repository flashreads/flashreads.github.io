<h1 id="data-validation-in-nodejs-applications-using-joi">Data Validation in Node.js Applications Using Joi</h1>

<p>Every application built consists of data. Be it a Web, Mobile or even Console based application, data is either displayed or accepted from a user as an input. Before you store the user input recieved, data validation is highly recommended to prevent the risk of a malicious SQL query being executed on your database. You can perform the data validation directly from the client side application where the input is recieved, and also at your server side application, before the data is stored. A Node.js package which you can use to perform data validation in Node.js applications is Joi.</p>

<p>Let’s proceed to get simplified understanding of Joi and see examples of how it can be used.</p>

<h2 id="what-is-joi">What is Joi?</h2>

<p>As described in the <a href="https://joi.dev/">Joi</a> documentation, “Joi is a data validator library for JavaScript”. Joi’s comprehensive API provides support for validating the data type of a value, and can also be extended to validate properties of a string. For example, checking the length of a string, or checking if a value is a valid email, or date within a specified range.</p>

<p>The first step to take when using Joi is to construct a schema. At it’s basics, a Joi schema is an object with fields that model the data being validated agaisnt. Let’s proceed to construct a schema for a user’s data within an imaginary application.</p>

<h2 id="modeling-a-user-data-schema">Modeling A User Data Schema</h2>
<p>For the imaginary application, we would expect that a user’s data must contain the following three fields;</p>

<ul>
  <li>A name field containing a string data type that has a minimum length of 5 characters and a maximum character count of 25</li>
  <li>A description field similar to the name field, but has a minimum acceptable character count of 50 and maximum count of 300.</li>
  <li>An email field containing a string data type with the “@” character. The email must have a <a href="http://data.iana.org/TLD/tlds-alpha-by-domain.txt">Top Level Domain</a> (TLD) of “.com”. A TLD is the last part of a domain, that is after the dot (.) character.</li>
</ul>

<pre><code class="language-JavaScript">  const Joi = require("joi")

  const userSchema = Joi.object({
    name: Joi.string().min(3).max(25).required(),
    description: Joi.string().alphanum().min(50).max(250).required(),
    email: Joi.string().email({
      tlds: { allow: ["com"] }
    }).required()
  });
</code></pre>

<p><strong>Note:</strong> Based on the needs for your application, you might have more fields within your schema. Visit the API section of the Joi documentation for a complete list of Joi’s API.</p>

<h2 id="validating-values-using-the-schema">Validating Values Using The Schema</h2>

<p>At this point there is now a <code class="highlighter-rouge">userSchema</code> variable contain a Joi schema that models a user application. Let’s go through the next code snipet below that explains how the schmea can be used.</p>

<p>You can validate data using the schema by calling the <a href="https://joi.dev/api/?v=17.4.2#assertvalue-schema-message-options">assert</a> method within the schema object and passing in the data to be validated agaisnt. The snippet below demonstrates how this is done;</p>

<pre><code class="language-JavaScript">const validateData = ({ name, description, email }) =&gt; {
  try {
     Joi.assert({ name, description, email }, userSchema);
  } catch (e) {
    console.log(`Erorr validating data: ${e}`)
  }
}

validateData({
   name: "John Doe",
    description: "Some pretty long and organized description of me the author",
    email: 'john.doe@gmail.com'
})
</code></pre>

<p>When the <code class="highlighter-rouge">validateData</code> function in the code snippet above is executed, the <code class="highlighter-rouge">name</code>, <code class="highlighter-rouge">description</code> and<code class="highlighter-rouge">email</code> arguments passed to the function will be validated using the <a href="https://joi.dev/api/?v=17.4.2#anyvalidatevalue-options">assert</a> method in the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/try...catch">try/catch</a> block. If the values don’t meet up with the validation standards, an exception will thrown and handled the catch block.</p>

<p>This forms the basic usage of the Joi Schema to for validating your data. You can also use the <a href="https://joi.dev/api/?v=17.4.2#anyvalidatevalue-options">validate</a> and <a href="https://joi.dev/api/?v=17.4.2#attemptvalue-schema-message-options">attempt</a> methods depending on your application’s needs.</p>
