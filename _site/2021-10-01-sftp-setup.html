<h1 id="sftp-configuration">SFTP Configuration</h1>

<h2 id="what-is-sftp">What is SFTP?</h2>

<p>SFTP (Secure File Transfer Protocol) is a file transfer protocol that leverages a set of utilities that provide secure access to a remote computer to deliver secure communications. It leverages SSH (Secure Socket Shell or Secure Shell) and is frequently also referred to as ‘Secure Shell File Transfer Protocol’.</p>

<h2 id="instructions">Instructions</h2>

<p>To install an SFTP server on a CENTOS Linux Server, follow the below steps:</p>
<ol>
  <li>Execute the following command to check whether SSH is installed
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> sudo rpm -qa | grep ssh
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>If SSH is not installed, run the following command
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> sudo yum install openssh-server
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Open port 22
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> sudo iptables -I INPUT -p tcp --dport 22 -j ACCEPT
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Create a user and provide new password for that user
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre> sudo useradd {user_name}
 sudo passwd {user_name}
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Create a directory for the file transfer and make the changes
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre> sudo mkdir {directory_name}
 sudo chgrp {user_name} {directory_name}
 sudo chown {user_name} {directory_name}
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>In /etc/ssh/sshd_config file add the below configuration:
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre> Match User {user_name}
 ForceCommand internal-sftp
 PubkeyAuthentication yes
 PasswordAuthentication yes
 ChrootDirectory {directory_name}
 PermitTunnel no
 AllowAgentForwarding no
 AllowTcpForwarding no
 X11Forwarding no
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Restart the SFTP Service
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> sudo systemctl restart sshd.service
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Testing(provide password on prompted)
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> sftp {user_name}@{server_address}
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ol>
