<h1 id="type-comparison">Type Comparison</h1>

<p>The most common way to determine if a given object is an <strong>instance</strong> of a given class, superclass or interface, is by using the binary operator <code class="highlighter-rouge">instanceof</code>. It includes implicit null check and generates a compile-time error if the types are not related. But it doesnâ€™t allow primitives and requires the types to be know at compile time.</p>

<h2 id="if-you-want-to-check-dynamically-at-runtime">If you want to check dynamically at runtime</h2>
<p>Use the equivalent method <code class="highlighter-rouge">boolean isInstance(Object obj)</code> in <code class="highlighter-rouge">Class</code>. It also includes null check, but allows for primitives:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>    <span class="n">a</span> <span class="k">instanceof</span> <span class="n">B</span> 
    <span class="c1">// returns false for null</span>
    <span class="kc">null</span> <span class="k">instanceof</span> <span class="n">B</span>

    <span class="n">a</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">isInstance</span><span class="o">(</span><span class="n">b</span><span class="o">);</span>
    <span class="c1">// commonly used for generics</span>
    <span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">type</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="na">getClass</span><span class="o">();</span>
    <span class="n">type</span><span class="o">.</span><span class="na">isInstance</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>

    <span class="c1">// Note that the parameter is autoboxed to type Integer</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">4</span><span class="o">;</span>
    <span class="n">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isInstance</span><span class="o">(</span><span class="n">x</span><span class="o">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="check-compatibility-of-two-types">Check compatibility of two types</h2>
<p>When you need to check subtyping relation use the method <code class="highlighter-rouge">boolean isAssignableFrom(Class&lt;?&gt; cls)</code> in <code class="highlighter-rouge">Class</code>. It may throw <em>NullPointerException</em>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>    <span class="c1">// is it possible to B b = new A()</span>
    <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">aClass</span> <span class="o">=</span> <span class="n">CharSequence</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
    <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">bClass</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
    <span class="n">bClass</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">aClass</span><span class="o">());</span>

    <span class="c1">// works for arrays</span>
    <span class="n">CharSequence</span><span class="o">[].</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">String</span><span class="o">[].</span><span class="na">class</span><span class="o">);</span> <span class="c1">// true</span>
    <span class="n">Integer</span><span class="o">[].</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">String</span><span class="o">[].</span><span class="na">class</span><span class="o">);</span> <span class="c1">//false</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="pattern-matching-java-14">Pattern Matching (Java 14)</h2>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>    <span class="k">if</span><span class="o">(</span><span class="n">a</span> <span class="k">instanceof</span> <span class="n">B</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// b is casted</span>
        <span class="n">b</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="special-types">Special types</h2>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>    <span class="c1">// Enums</span>
    <span class="kd">enum</span> <span class="n">Color</span> <span class="o">{</span> <span class="n">WHITE</span><span class="o">,</span> <span class="n">GRAY</span><span class="o">,</span> <span class="n">BLACK</span> <span class="o">}</span>

    <span class="n">Color</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isEnum</span><span class="o">();</span> <span class="c1">// Enum.class.isAssignableFrom(Color.class); </span>
    <span class="n">Color</span><span class="o">.</span><span class="na">WHITE</span> <span class="k">instanceof</span> <span class="n">Enum</span><span class="o">;</span> <span class="c1">// true</span>

    <span class="c1">// Arrays</span>
    <span class="n">String</span><span class="o">[].</span><span class="na">class</span><span class="o">.</span><span class="na">isArray</span><span class="o">();</span>
    <span class="c1">// get the type of the variables in an array (null if obj is not an array)</span>
    <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">componentType</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="na">getComponentType</span><span class="o">();</span> 

    <span class="c1">// Primitives</span>
    <span class="kt">int</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isPrimitive</span><span class="o">();</span>
</pre></td></tr></tbody></table></code></pre></div></div>
